FROM tensorflow/tensorflow

RUN useradd -m predictor

WORKDIR /app
COPY predictor/ .

ENV PORT 8668
RUN apt update -y
RUN apt install curl -y
RUN pip3 install --upgrade --no-cache-dir -r requirements.txt

RUN chown -R root:predictor /app && \
    chmod 750 /app /app/main.py

USER predictor

CMD ["python", "/app/main.py"]

EXPOSE 8668